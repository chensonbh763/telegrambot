<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Check-in Diário - LucreMais</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://sdk.adsonar.io/js/latest.js"></script>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 30px; background: #f9f9f9; }
    button { padding: 12px 24px; font-size: 1.1rem; background: #2a8f43; color: white; border: none; border-radius: 5px; cursor: pointer; }
    #mensagem { margin-top: 20px; font-weight: bold; }
  </style>
</head>
<body>

  <h2>🎁 Check-in Diário</h2>
  <p>Clique abaixo, assista ao anúncio e ganhe pontos!</p>
  <button onclick="fazerCheckin()">📺 Fazer Check-in</button>
  <div id="mensagem">...</div>

  <script>
    const telegram_id = new URLSearchParams(location.search).get("id") || "0000";

    function fazerCheckin() {
      window.Sonar.show({
        adUnit: 'checkin_diario',
        onReward: () => {
          fetch("/api/checkin", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ telegram_id })
          })
          .then(res => res.json())
          .then(data => {
            document.getElementById("mensagem").innerText = data.mensagem;
          })
          .catch(() => {
            document.getElementById("mensagem").innerText = "❌ Erro ao registrar pontos.";
          });
        },
        onError: () => alert("❌ Erro ao carregar anúncio."),
        onClose: () => console.log("Anúncio fechado")
      });
    }
  </script>

</body>
</html>
